installation:
  download:
    template: "https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-{version}-{os}-{arch}.zip"

    mappings:
      os:
        linux: "linux"
        mac: "macosx"
      arch:
        x86_64: "x64"
        amd64: "x64"
        arm64: "aarch64"
        aarch64: "aarch64"

configuration:
  # Fetch latest version dynamically from GitHub releases
  default_version: "${SONAR_SCANNER_VERSION:-$(curl -s https://api.github.com/repos/SonarSource/sonar-scanner-cli/releases/latest | jq -r '.tag_name' | sed 's/^v//')}"

  environments:
    SONAR_SCANNER_HOME: "${install_dir}"
    PATH: "${install_dir}/bin"

  post_configuration_script: |
    info "✓ SONAR_SCANNER_HOME: ${install_dir}"
    info "✓ SonarScanner version: $(sonar-scanner --version | head -n 1)"
