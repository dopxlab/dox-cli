installation:
  download:
    template: "https://github.com/argoproj/argo-cd/releases/download/{version}/argocd-{os}-{arch}"
    mappings:
      os:
        mac: "darwin"
      arch:
        x86_64: "amd64"
        aarch64: "arm64"

    # Optional explicit override (higher priority)
    #"2.11.0":
    #  mac-arm64:   "https://github.com/argoproj/argo-cd/releases/download/v2.11.0/argocd-darwin-arm64"
    #  mac-x86_64:  "https://github.com/argoproj/argo-cd/releases/download/v2.11.0/argocd-darwin-amd64"
    #  linux-arm64: "https://github.com/argoproj/argo-cd/releases/download/v2.11.0/argocd-linux-arm64"
    #  linux-x86_64:"https://github.com/argoproj/argo-cd/releases/download/v2.11.0/argocd-linux-amd64"

configuration:
  default_version: "${ARGOCD_VERSION:-$(curl -s https://api.github.com/repos/argoproj/argo-cd/releases/latest | jq -r '.tag_name')}"

  environments:
    PATH: "${install_dir}"

  post_configuration_script: |
    #!/bin/bash
    if [ -d "$install_dir" ] && compgen -G "$install_dir/*" > /dev/null; then
      mv "$install_dir/"* "$install_dir/argocd"
      chmod +x "$install_dir/argocd"
    fi
    create_symlinks_to_bin $install_dir
    info "âœ“ $(argocd version --client)"