actions:
  # Call each export action by the prefix dox export-vars
  global-vars: |
    dox export BUILD_VERSION
    dox export GIT_REPOSITORY_NAME
    dox export GIT_BRANCH_NAME
    dox export GIT_COMMITTER_NAME
    dox export GIT_COMMITTER_EMAIL
    dox export GIT_COMMIT_URL
    dox export GIT_COMMIT_ID
    dox export GIT_COMMIT_SHORT_ID
    dox export GIT_COMMIT_MESSAGE
    dox export GIT_BRANCH_PREFIX
    dox export GIT_PIPELINE_URL

  # Generate BUILD_VERSION
  BUILD_VERSION: |
    timestamp_version=$(date +"%Y%m%d.%H%M%S" | sed 's/^0//').0
    echo "BUILD_VERSION=\"${BUILD_VERSION:-$timestamp_version}\"" | tee -a $DOX_ENV

  # Git Repository Name
  GIT_REPOSITORY_NAME: |
    repo_name=$(basename "$(git config --get remote.origin.url)" .git)
    echo "GIT_REPOSITORY_NAME=\"$repo_name\"" | tee -a $DOX_ENV

  # Git Branch Name
  GIT_BRANCH_NAME: |
    branch_name="${GITHUB_REF#refs/heads/}"
    echo "GIT_BRANCH_NAME=\"$branch_name\"" | tee -a $DOX_ENV

  # Git Committer Name
  GIT_COMMITTER_NAME: |
    committer_name=$(git -C . log -1 --pretty=format:'%an')
    echo "GIT_COMMITTER_NAME=\"$committer_name\"" | tee -a $DOX_ENV

  # Git Committer Email
  GIT_COMMITTER_EMAIL: |
    committer_email=$(git -C . log -1 --pretty=format:'%ae')
    echo "GIT_COMMITTER_EMAIL=\"$committer_email\"" | tee -a $DOX_ENV

  # Git Commit URL
  GIT_COMMIT_URL: |
    commit_url=$(git config --get remote.origin.url | sed 's/tatasteel-dod@//')/commit/$(git rev-parse HEAD)
    echo "GIT_COMMIT_URL=\"$commit_url\"" | tee -a $DOX_ENV

  # Git Commit ID
  GIT_COMMIT_ID: |
    commit_id=$(git rev-parse HEAD)
    echo "GIT_COMMIT_ID=\"$commit_id\"" | tee -a $DOX_ENV

  # Short Git Commit ID
  GIT_COMMIT_SHORT_ID: |
    short_commit_id=$(git rev-parse --short HEAD)
    echo "GIT_COMMIT_SHORT_ID=\"$short_commit_id\"" | tee -a $DOX_ENV

  # Git Commit Message
  GIT_COMMIT_MESSAGE: |
    commit_message=$(git log -1 --pretty=%B | tr -d '\n' | tr -d "'" | tr -d '"')
    echo "GIT_COMMIT_MESSAGE=\"$commit_message\"" | tee -a $DOX_ENV

  # Git Branch Prefix
  GIT_BRANCH_PREFIX: |
    branch_prefix=$(git rev-parse --abbrev-ref HEAD | cut -d/ -f1)
    echo "GIT_BRANCH_PREFIX=\"$branch_prefix\"" | tee -a $DOX_ENV

  # Git Pipeline URL
  GIT_PIPELINE_URL: |
    pipeline_url="${GITHUB_SERVER_URL}/${GITHUB_REPOSITORY}/actions/runs/${GITHUB_RUN_ID}"
    echo "GIT_PIPELINE_URL=\"$pipeline_url\"" | tee -a $DOX_ENV
